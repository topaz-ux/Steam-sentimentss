<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam ë¦¬ë·° ê°ì • ë¶„ì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-success {
            background: #28a745;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-card p {
            color: #666;
            font-size: 0.9em;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .image-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .image-card img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .image-card h4 {
            margin-top: 10px;
            color: #333;
            text-align: center;
        }

        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .two-columns {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® Steam ë¦¬ë·° ê°ì • ë¶„ì„</h1>
        <p class="subtitle">Steam ê²Œì„ ë¦¬ë·°ë¥¼ ìŠ¤í¬ë˜í•‘í•˜ê³  ê°ì • ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤</p>

        <!-- ìŠ¤í¬ë˜í•‘ ì„¹ì…˜ -->
        <div class="section">
            <h2>1ï¸âƒ£ ë¦¬ë·° ìŠ¤í¬ë˜í•‘</h2>
            <div class="form-group">
                <label for="game_id">Steam ê²Œì„ ID:</label>
                <input type="text" id="game_id" value="730" placeholder="ì˜ˆ: 730 (Counter Strike 2)">
                <small style="color: #666;">Steam ìŠ¤í† ì–´ í˜ì´ì§€ URLì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</small>
            </div>
            <div class="form-group">
                <label for="game_name">ê²Œì„ ì´ë¦„:</label>
                <input type="text" id="game_name" value="Counter Strike 2" placeholder="ê²Œì„ ì´ë¦„">
            </div>
            <div class="form-group">
                <label for="num_reviews">ìˆ˜ì§‘í•  ë¦¬ë·° ìˆ˜:</label>
                <input type="number" id="num_reviews" value="50" min="10" max="500">
            </div>
            <button class="btn" onclick="scrapeReviews()">ë¦¬ë·° ìŠ¤í¬ë˜í•‘ ì‹œì‘</button>
            <div id="scrape-status" class="status"></div>
            <div id="scrape-loading" class="loading">
                <div class="spinner"></div>
                <p>ë¦¬ë·°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
            </div>
        </div>

        <!-- ê°ì • ë¶„ì„ ì„¹ì…˜ -->
        <div class="section">
            <h2>2ï¸âƒ£ ê°ì • ë¶„ì„</h2>
            <button class="btn btn-success" onclick="analyzeSentiment()">ê°ì • ë¶„ì„ ìˆ˜í–‰</button>
            <div id="analyze-status" class="status"></div>
            <div id="analyze-loading" class="loading">
                <div class="spinner"></div>
                <p>ê°ì • ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>
            <div id="stats-container" style="display: none;">
                <h3 style="margin-top: 20px; color: #333;">ğŸ“Š ë¶„ì„ ê²°ê³¼</h3>
                <div class="stats-grid" id="stats-grid"></div>
            </div>
        </div>

        <!-- ì‹œê°í™” ì„¹ì…˜ -->
        <div class="section">
            <h2>3ï¸âƒ£ ì‹œê°í™” ìƒì„±</h2>
            <button class="btn btn-secondary" onclick="createVisualizations()">ì‹œê°í™” ìƒì„±</button>
            <div id="visualize-status" class="status"></div>
            <div id="visualize-loading" class="loading">
                <div class="spinner"></div>
                <p>ì‹œê°í™”ë¥¼ ìƒì„±í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>
            <div id="image-gallery" class="image-gallery" style="display: none;"></div>
        </div>

        <!-- ë°ì´í„° ë‹¤ìš´ë¡œë“œ ì„¹ì…˜ -->
        <div class="section">
            <h2>4ï¸âƒ£ ë°ì´í„° ë‹¤ìš´ë¡œë“œ</h2>
            <button class="btn btn-secondary" onclick="downloadCSV()">CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
        </div>
    </div>

    <script>
        async function scrapeReviews() {
            const gameId = document.getElementById('game_id').value;
            const gameName = document.getElementById('game_name').value;
            const numReviews = document.getElementById('num_reviews').value;

            const statusDiv = document.getElementById('scrape-status');
            const loadingDiv = document.getElementById('scrape-loading');
            const btn = event.target;

            btn.disabled = true;
            loadingDiv.style.display = 'block';
            statusDiv.style.display = 'none';

            try {
                const response = await fetch('/api/scrape', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        game_id: gameId,
                        game_name: gameName,
                        num_reviews: numReviews
                    })
                });

                const data = await response.json();
                loadingDiv.style.display = 'none';

                if (data.success) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = `âœ… ${data.message}`;
                    statusDiv.style.display = 'block';
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `âŒ ${data.message}`;
                    statusDiv.style.display = 'block';
                }
            } catch (error) {
                loadingDiv.style.display = 'none';
                statusDiv.className = 'status error';
                statusDiv.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                statusDiv.style.display = 'block';
            } finally {
                btn.disabled = false;
            }
        }

        async function analyzeSentiment() {
            const statusDiv = document.getElementById('analyze-status');
            const loadingDiv = document.getElementById('analyze-loading');
            const statsContainer = document.getElementById('stats-container');
            const statsGrid = document.getElementById('stats-grid');
            const btn = event.target;

            btn.disabled = true;
            loadingDiv.style.display = 'block';
            statusDiv.style.display = 'none';

            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                const data = await response.json();
                loadingDiv.style.display = 'none';

                if (data.success) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = `âœ… ${data.message}`;
                    statusDiv.style.display = 'block';

                    // í†µê³„ í‘œì‹œ
                    const stats = data.stats;
                    statsGrid.innerHTML = `
                        <div class="stat-card">
                            <h3>${stats.total_reviews}</h3>
                            <p>ì „ì²´ ë¦¬ë·°</p>
                        </div>
                        <div class="stat-card">
                            <h3>${stats.recommended}</h3>
                            <p>ì¶”ì²œ ë¦¬ë·°</p>
                        </div>
                        <div class="stat-card">
                            <h3>${stats.not_recommended}</h3>
                            <p>ë¹„ì¶”ì²œ ë¦¬ë·°</p>
                        </div>
                        <div class="stat-card">
                            <h3>${stats.avg_compound_score.toFixed(3)}</h3>
                            <p>í‰ê·  ê°ì • ì ìˆ˜</p>
                        </div>
                    `;
                    statsContainer.style.display = 'block';
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `âŒ ${data.message}`;
                    statusDiv.style.display = 'block';
                }
            } catch (error) {
                loadingDiv.style.display = 'none';
                statusDiv.className = 'status error';
                statusDiv.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                statusDiv.style.display = 'block';
            } finally {
                btn.disabled = false;
            }
        }

        async function createVisualizations() {
            const statusDiv = document.getElementById('visualize-status');
            const loadingDiv = document.getElementById('visualize-loading');
            const imageGallery = document.getElementById('image-gallery');
            const btn = event.target;

            btn.disabled = true;
            loadingDiv.style.display = 'block';
            statusDiv.style.display = 'none';

            try {
                const response = await fetch('/api/visualize', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                const data = await response.json();
                loadingDiv.style.display = 'none';

                if (data.success) {
                    statusDiv.className = 'status success';
                    statusDiv.textContent = `âœ… ${data.message}`;
                    statusDiv.style.display = 'block';

                    // ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ í‘œì‹œ
                    if (data.images && data.images.length > 0) {
                        imageGallery.innerHTML = data.images.map(img => `
                            <div class="image-card">
                                <img src="/images/${img}" alt="${img}" 
                                     onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22300%22%3E%3Crect width=%22100%25%22 height=%22100%25%22 fill=%22%23f0f0f0%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-size=%2214%22 fill=%22%23666%22%3Eì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤%3C/text%3E%3C/svg%3E';">
                                <h4>${img.replace('.png', '').replace(/_/g, ' ')}</h4>
                            </div>
                        `).join('');
                        imageGallery.style.display = 'grid';
                    } else {
                        imageGallery.innerHTML = '<p style="text-align: center; color: #666;">ìƒì„±ëœ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                        imageGallery.style.display = 'block';
                    }
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = `âŒ ${data.message}`;
                    statusDiv.style.display = 'block';
                }
            } catch (error) {
                loadingDiv.style.display = 'none';
                statusDiv.className = 'status error';
                statusDiv.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`;
                statusDiv.style.display = 'block';
            } finally {
                btn.disabled = false;
            }
        }

        function downloadCSV() {
            window.location.href = '/api/download';
        }
    </script>
</body>
</html>

